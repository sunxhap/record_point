> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 https://mp.weixin.qq.com/s/gBdcaAx8EInRXPUGeJ5ljQ

<section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px; color: black; padding-right: 10px; padding-left: 10px; line-height: 1.6; letter-spacing: 0px; word-break: break-word; overflow-wrap: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif; visibility: visible;">

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">`r0env`：打造年轻人的第一套安卓逆向环境！</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">系统环境</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">用户选择</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">终端选择</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">文件传输</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">科学工具</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">`Frida`版本管理</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">`Frida`开发环境</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">动态分析工具：android-studio</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">动态分析工具：ddms</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">静态分析工具：jadx</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">动静态分析工具：jeb</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">动态分析工具：集成 HyperPwn</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">静态分析工具：010 editor</section>

*   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; color: rgb(1, 1, 1); visibility: visible;">抓包工具：Charles</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">抓包工具：BurpSuite</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">抓包工具：`WireShark`</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">刷机相关：刷机环境</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">最终效果：</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">PC 环境：基于`Kali Linux 2021.1`的 r0env</section>

</section>

<section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;overflow-wrap: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;">

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">`r0env`：打造年轻人的第一套安卓逆向环境！
    </section>

这是一套专门为小白打造的安卓逆向工程环境，越是白里透红，越是这套环境的目标用户。

大家都知道，准备安卓逆向环境是一件非常枯燥、充满重复劳动、且高度依赖科学网络的事情，使用这个环境可以省去这些烦恼和时间，开箱即用，快捷方便；且环境全程位于虚拟机中，干净卫生。

拥有这套配好的环境，可以让新手的逆向工程变得无比丝滑，事半功倍；你唯一要做的就是点击文末的链接下单买一部手机，所有的环境已经具备，按照操作流程进行操作即可，可以避免无数人已经踩好的无数坑。（各组件也有下载链接，并且完全开源，高手自用自取）

准备环境，还是一件充满技术含量的事情。Frida 各版本安装、匹配、切换，各种抓包软件，好的沙箱全自动辅助分析逆向、自吐核心数据、控制流程直接定位关键算法，一款好的手机无论刷`Fart`或`Kali Nethunter`还是自己编译安卓源码刷机都能游刃有余。

拥有这套配好的环境，可以让新手的逆向技术变得无比强大，各种新手连安装和配置都不会的 “秒杀”“自吐”“自动化” 等中高阶逆向技术或工具直接封装在环境和沙箱之中，新手用上后直接起飞，各种大杀器无缝匹配轻松搓搓大连招，油门一踩、尾灯一甩、连夜上山，一晚逆几百个 App，享受从未经历过的稳、准、狠高速逆向体验。

这就是`r0env`，为年轻人、新手、小白们打造的一套安卓逆向环境！当然这其实也是我的日常环境，分享出来为大家提高效率、减少重复劳动做点贡献，也可以在一起交流问题时，有一个统一的环境，降低沟通成本，避免南辕北辙，鸡同鸭讲的窘境。

成套`r0env`环境由三部分组成：

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">PC 环境：打包好的`Kali Linux`操作系统，解压即用，已内置常用工具，省时省心；</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">沙箱：自己从源码编译的安卓系统，加入诸多关键日志打印和信息自吐，暴调用栈等功能，从系统出发降维攻击 App，App 的所有行为一览无余；</section>

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">真机：承载各种 ROM 的载体，主要为 Nexus、Pixel、Redmi、OnePlus 等易于刷机的品牌及 ROM 全家桶。</section>

现在，让我们系上安全带，老司机要发车了。上车的乘客请主动刷卡、投币或扫码乘车，上车后请往里走，谢谢您的配合。

### PC 环境：基于`Kali Linux 2021.1`的 r0env

车辆在运行中，请您站稳扶牢，前方到站，电脑系统站。

在系统的选择上，既不选`Windows`，也不选`macOS`，这二者都不是为安卓逆向工程师所准备的，在这两款系统上部署安卓逆向环境而遇到的血与泪的教训简直是罄竹难书，随手举个案例吧，这是`Frida`在`cmd`下的`hexdump`效果：

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tKiaJVDltTtav0iaEO70AavNCCWEexgZBiaQgKSLJOBPr4UeHVvPIYLhGw/640?wx_fmt=png)

我们要用的工具在`Kali Linux`下面都是一把梭，在`Windows`或者`macOS`下真的是一千零一种出错方法，什么错法都能有，`macOS`那些奇奇怪怪的`Xcode`和`Sdk`还有阉割版的包管理器，注定不是为专业`Linux`和安卓开发而生。

诸多踩坑大佬血泪控诉，千万别用 Windows！

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0ttUkOZOVfu2da6SSEDvE2vSOeUsFKcrxSCuDUdHFZ4I1JicdQcrhfTUA/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t7rRwMv6iapfhoO6OLtx2QSUUzibqQFVPWwkjqibpbwGr6icDrAuPhcR4eQ/640?wx_fmt=jpeg)

在系统的选择上我们推荐`Kali Linux`，`Kali Linux`是基于`Debian`的`Linux`发行版，与`Ubuntu`师出同门，是设计用于数字取证操作系统。`Kali Linux`预装了许多渗透测试软件，包括`Metasploit`、`BurpSuite`、`sqlmap`、`nmap` 、以及`Cobalt Strike`等，是一整套开箱即用的专业渗透测试工具箱。

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tt2g8TqWJ2rlia4TzX1EKS9Hg5LlQIn2JshrzAfTZWHWMFXNPiag7FLIg/640?wx_fmt=png)

`Kali Linux`自带`Vmware`镜像版本，下载解压双击打开`.vmx`文件即可开机。后续不管是`Frida`工作开发环境，`Android Studio`安装、`ndk`开发、抓包环境，自制路由器抓包等，`gdb`、`lldb`调试，甚至更加进阶的`Ollvm`开发，`ART`虚拟机定制开发，`AOSP`源码阅读或编译等，都将在`Kali Linux`操作系统中完成。如果使用 Windows、macOS，将会耗费大量的时间在莫名 bug 的定位和消除上，而时间的成本是很高的。

#### 系统环境

使用虚拟机而不是真机，首先是因为虚拟机自带 “时光机” 功能，可以“时光倒流”，下图为寒冰大佬日常工作内容中，开发`FART`脱壳机时，创建的诸多虚拟机快照。

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tCfDmx70ITIqo4icHtsib9PVAq6Mrulmx6mr9BG3JLOlYR7pI4PU4eoPQ/640?wx_fmt=png)

其次虚拟机具有良好的跨平台特性，而`VMWare`完美支持`Windows`、`macOS`和`Linux`三大主流桌面平台。可以随时将完整的学习和工作环境整体打包，在各种环境中进行部署和迁移，比如现在笔者就是在将环境打包分享给大家。

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tWHRibAjjoW6AxazO91EuZrQLQcfY6yiacGiaveyzicLu5HqKgMkrdRjwqw/640?wx_fmt=png)

最后，虚拟机具有良好的隔离特性，做实验不会 “污染” 真机，是测试全新功能的天然“沙盘”，推荐读者使用`VMware`出品的系列虚拟机，笔者打包的也是`VMware`的`Kali Linux`虚拟机。

#### 用户选择

新款`Kali Linux`虚拟机，默认用户是`Kali`，对于我们专业安卓逆向人员来说，用`root`用户可以更加心无旁骛地专注于工作本身，并且不必理会烦人的`pip`安装究竟要不要带`sudo`问题，彻底解决我的`pip`包到底装在了哪里这样的世纪难题。

扔掉烦人的`sudo`，一切都变得简单无比，当然运维请不要学习咱门这些陋习哈，一切皆在`root`用户下操作是非常危险的。

笔者已经重新将`root`用户开启，大家在开机后用户填写`root`，密码填写`toor`即可进入系统。

原装`Kali Linux`开机时时区是不对的，会影响抓包。笔者已经将时区调整到东八区，时间会联网时与授时服务器自动同步，后续免维护。

#### 终端选择

`Kali Linux`最新版本的默认`Shell`是`Zsh`，`Zsh`虽然方便，但其并不兼容且不能运行诸多编译系统，我们应该回退到`bash`。

按照官网的方式，执行`chsh -s /bin/bash`后重启，回退到`bash`。大家打开虚拟机，按快捷键`ctrl + alt + t`默认打开的就是`bash`了。

在`bash`中，命令是可以补全的，按键盘上的 tab 键。

经常有学员问我，老师你命令敲的那么快，根本记不住怎么办？

其实根本不用记，只要记得用的啥工具就好，然后用`history`命令就好了，我已经把`HISTSIZE`调成了一百万条，系统会存储你用过的一百万条命令，不用记命令也不用记路径。比如想看曾经用过的`pyenv`的命令：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tlJOxsVMSKBlB2nd6xIeB1hzOaCe14nqxhcbe3S0glja225C62Q0s0A/640?wx_fmt=jpeg)

#### 文件传输

虽然`Kali Linux`支持文件直接拖拽进虚拟机，但是`VMware tools`默认会缓存一份在`/root/.cache/vmware/drag_and_drop`目录下，久而久之非常占空间。如果习惯使用拖拽的方式传文件，一定要记得多加清理这个目录。这里还是建议使用`ssh`服务来传递文件。

开启`ssh`服务，可以在虚拟机外使用`FileZilla`将文件传进虚拟机内，尤其是动辄数十 G 的`AOSP`源码，不会产生任何缓存，轻松高效。命令只需一句话：

```
# /etc/init.d/ssh start
```

#### 科学工具

推荐将科学工具运行在宿主机上，打开`socks5`服务期并允许来自局域网的连接。

推荐两种科学工具：

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">`proxychains`的话编辑`/etc/proxychains4.conf`，在文末按照格式添加宿主机的 IP 和科学端口即可。最终效果如下：</section>

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t3Y2WKwfMr5DicsManBzZVS8vEDTB6TsdJzMhiaI63ybXZiciaT5kicturIQ/640?wx_fmt=jpeg)

*   <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">`redsocks`的话编辑`/etc/redsocks.conf`，更改`ip`和`port`为宿主机的 IP 和科学端口即可。也要编辑`iptables.sh`文件，添加不重定向的地址为宿主机的 IP。最终效果如下：</section>

```
// `ip' and `port' are IP and tcp-port of proxy-server        // You can also use hostname instead of IP, only one (random)        // address of multihomed host will be used.        ip = 192.168.179.1;        port = 1080;
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tymPichFcUiaMYvVKdRPdgugKk3YeRickEN5KZHrF3fbCuFCLsAudqFeZA/640?wx_fmt=jpeg)

`proxychains`只对单条命令生效。`redsocks`+`iptables`是全局有效，重启后失效。

这两种科学方案目前已经能满足我`90%`的需求，美中不足的它们都是走的协议。其实还有一种路由科学，那才是可以`ping google.com`的真正的科学，这里不再赘述。

#### `Frida`版本管理

在`r0capture`的维护过程中，我遇到的最多的问题就是，找不到设备！明明`frida-ps -U`都能回显进程了，但`python3 r0capture.py -U -f com.qiyi.video -v`命令就是找不到设备，怎么重装都不对。

虽然大半原因是`Windows`的功劳，但还有一部分原因是`python`版本管理混乱造成的，在我给的这个环境里，则可以彻底根治这个问题，那就是使用`pyenv`来管理`python`环境，顺便实现`Frida`版本随意切的效果。

有人经常问我，我的电脑已经装了最新的`frida`了，但是我还想装个老版本跑老的脚本，或者甚至有大佬问过我：“手机和电脑安装的是同一个版本的 frida，有多个手机，8.1 以下用 frida12，8.1 以上用 frida14，那岂不是也要有两个电脑，一个装 frida12，一个装 frida14 白眼这个问题都是怎么处理的？”

这个问题的答案也是`pyenv`！不用买两个电脑！！

本环境已经装好`pyenv`了，在任意目录下，切换`python`环境，则切换了`frida`的版本。最终效果和命令如下：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t2ByTiclbENR0DDuCNkCKwfiawY4pQKv1X7ic794jYUzZn44SVtAHmQjkA/640?wx_fmt=jpeg)

#### `Frida`开发环境

不知道是谁发的帖子，或者大家是看的哪个大佬的教程，总之这位大佬以一己之力，将整个`Frida`开发环境姿势和开发圈全都带偏了。甚至连大名鼎鼎的交大`GOSSIP`实验室，也在写这样`py`和`js`混编的代码！(下图来自：[《特斯拉又双叒出问题了？这一次可是手机远程启动的安全风险！》](https://mp.weixin.qq.com/s?__biz=MzI5NzI5NzY1MA==&mid=2247483726&idx=1&sn=82665700d9615d504e4aa1d1f756b860&scene=21#wechat_redirect))

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tEiaViceUY25EEiaL0qgc9X4YAgQHZzfbIvc6VgvunvlHwgqlb18ZBMqeg/640?wx_fmt=jpeg)

我在课程里总结了使用`Frida`进行逆向的三个主要步骤：

1.  <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">`hook`定位：先`hook`、看参数和返回值</section>

2.  <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">主动调用：构造参数、主动调用、查看结果</section>

3.  <section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">批量调用：配`rpc`批量大规模自动化调用</section>

每一步搞完了再进入下一步，第一步和第二步，都是不需要`python`的，搞`python`都只会另事情更加复杂，看不懂报错之间的关联，定位不到问题，且没有任何有帮助的意义，`python`唯一的帮助就是用于自动化。

本环境中已经配置好了`frida`的开发环境，在任意目录下编写`js`都有`frida`的代码提示，按住`ctrl`点`api`阅读源码，回车补全 (代码块)，等方便的开发功能，

打开目录：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t81S1aagnuMeKXYfWnX3rv1YrdD4RYHVbQhDkOxnJrKv6JaLfOjWhQA/640?wx_fmt=jpeg)

编写第一、二步的`hook`和主动调用代码：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tPah0icYSDnhWkfN90ic4s5yibIxSBC8FR7A0ztagBkVxPc672ficLgr2Vg/640?wx_fmt=jpeg)

代码写完之后，按`vscode`的快捷键`ctrl + ~`，即可调出`vscode`的内置终端，使用`pyenv`设置好`python`版本，即可开始用`frida`命令，来跑刚刚写好的脚本了，如有报错，在这一步就`debug`测试完成。

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tKRGrpQWx5bz4GLWaachzZtyV3rNPmDogY56q7alGibbeiafxpvxc6dGQ/640?wx_fmt=jpeg)

当然，还有第三步的`rpc`，也配好了。

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tAcG8Q3ayYhCiagicm5kO7lsG7phkYicPkhRSiae2KKZibice9EbaNaPukFZQ/640?wx_fmt=jpeg)

最后我把几个常用的`frida-server`版本和`hluda`也放在`/root/Desktop/frida-server`目录下了，也给了下载地址，想要下载哪个版本直接点击链接去下载即可。

当然，`objection`是跟着`frida`走的。

再安装新的`python`版本：

```
# proxychains  pyenv install 3.8.6
```

切到新安装的`python`版本中去：

```
# pyenv local 3.8.6
```

安装特定版本的`frida`及对应的`objection`版本（务必加上`proxychains`，否则会经常安装失败）：

https://t.zsxq.com/uVNfe2v

某个环境玩腻了之后，删除它：

```
# pyenv uninstall 3.8.6
```

#### 动态分析工具：android-studio

经常有人来问我`android studio`无法下载`gradle`，我也给大家准备好了。

首先连接手机：（前提是手机上开启 wifiadb，如果用手机线连接，在插入手机时 VMware 会弹出询问，选择连接到虚拟机)

```
# adb connect 192.168.0.185# adb devicesList of devices attached192.168.0.185:5555      device
```

`sdk`和`ndk`都安装并且同步好了，最新版本，打开`android studio`即可连接手机调试。打开`as`：

```
# /root/Desktop/android-studio/bin/studio.sh
```

运行`app`：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tZZw1xOFOdQbjiajGibT8hHUkk7Jphkd7ibPkO79xx3SkIEA4VZHlVibNZg/640?wx_fmt=jpeg)

手机投屏是`scrcpy`命令，在任意终端输入该命令即可：

```
# scrcpy 
```

只要`adb`连接上了，手机投屏就会打开。

#### 动态分析工具：ddms

`DDMS`以前是我们用的很多的`trace`工具，在`Kali`里当然也可以用，开启`DDMS`之前也要确保`adb`连上了。

```
# adb connect 192.168.0.141# adb devicesList of devices attached192.168.0.141:5555      device
```

开启`DDMS`:

```
# /root/Android/Sdk/tools/lib/monitor-x86_64/monitor
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t3b97zSrSarJQIm9AF5B6rUX7SyW4Td71uibSlUTw8j14lwAIUwDehyQ/640?wx_fmt=jpeg)

有时候在查看`trace`后的方法时，配色会干扰查看效果，这时可以更换一下配色。开始 → `Settings Manager` → `Appearance` ，默认是`Kali Dark`，可以改成`Kali Light`，则可以看到`trace`到的方法细节。看个人喜好，如果喜欢`Kali Dark`，可以用完后再改回来。

#### 静态分析工具：jadx

已经把`jadx`系列命令加入到了终端环境中，可以在任意目录下直接`jadx-gui xxx.dex`打开查看`dex`的反编译结果。

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0teTzEUjDx0FjnicKVPomMXwwY9O84LKMxiazGfFld9DR4bSns6LheRpEw/640?wx_fmt=jpeg)

#### 动静态分析工具：jeb

```
# /root/Desktop/jeb/jeb_linux.sh
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tuXojGa83MRm7oJjAibHw9Tp6InxqbOOwdQS06Zp5YTlWAicw7HbbbohQ/640?wx_fmt=jpeg)

#### 动态分析工具：集成 HyperPwn

经常有人反馈`HyperPwn`安装困难，这里俺也已经集成好了，直接输入`hyper`命令即可开启。

```
# hyper
```

打开的窗口中输入`gdb-multiarch`即可进入`HyperPwn`。搭配的是`pwndb`。最终效果如下：

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tyQWOCuQeaAE6Ycw4pmyjYszUqf6lmv9aGA9dZ80ZYfw4WbsbE0kWXQ/640?wx_fmt=png)

#### 静态分析工具：010 editor

开始 → `010 editor`

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tiaBWNn545L47fIjiao7fDDuzARQZ1B6gpJ6cVQsjHHcYERt4FI9qRWjA/640?wx_fmt=jpeg)

无限续期：

https://t.zsxq.com/unYz7uN

#### 抓包工具：Charles

```
# /root/Desktop/charles/bin/charles
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tkp8hVOv7ygahdibDTYU6GVCbnZn5TUTU9iakxxIyUHibQCXHdwYIiaDEsw/640?wx_fmt=jpeg)

后续俺还会将该版本`Charles`的证书直接编译到沙箱中去，配套进行使用，免去经过用户分区、以及`remount`各种失败或异常之苦。

#### 抓包工具：BurpSuite

```
# cd /root/Desktop/burp/ # java -jar /root/Desktop/burp/burploader.jar
```

然后点击 `Run`：

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tpqZZHAS0d5MhCVaCIKaqN8siaXEImZMZd3lEvn8ia27WPBXLAVibtVGhA/640?wx_fmt=jpeg)

#### 抓包工具：`WireShark`

任意窗口敲`wireshark`命令即可。

![](https://mmbiz.qpic.cn/mmbiz_jpg/7ePucpwVj77IagJVLsoC3ycvh1SlWv0t56rNtt3BNhQh4CnwibMF4R7BeSRJvH1sOe4uNXskXvvfByepw6xIjibQ/640?wx_fmt=jpeg)

制作路由器抓包的`nm-connection-editor`命令在 2021 版本上貌似有`bug`，后续版本中再进行研究。

推荐大家直接使用我的沙箱，在手机上开启`Wireshark`直接抓包，将抓到的包`scp`复制到虚拟机中再用`Wireshark`打开进行分析即可。

该工具在沙箱抓包部分将会有巨大的使用场景，后续敬请期待。

#### 刷机相关：刷机环境

to-do...

> 安卓 6：crypto_filter_aosp 安卓 7：youpk + 新版本 frida_fart 安卓 8：fart 并回填 安卓 10：fart10

#### 最终效果：

![](https://mmbiz.qpic.cn/mmbiz_png/7ePucpwVj77IagJVLsoC3ycvh1SlWv0tXgQFeHxPZhTzgBpKrcpwOQvGicOBzxsK6vCibKmBcEibR6wUvfqw9CkCw/640?wx_fmt=png)</section>